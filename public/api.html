

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API documentation &mdash; Congrads 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="_static/congrads_favicon.png"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=292eb321"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Core concepts" href="concepts.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #cc5353" >

          
          
          <a href="index.html" class="icon icon-home">
            Congrads
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="start.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="concepts.html">Core concepts</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-congrads.checkpoints">Checkpoints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#congrads.checkpoints.CheckpointManager"><code class="docutils literal notranslate"><span class="pre">CheckpointManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.checkpoints.CheckpointManager.evaluate_criteria"><code class="docutils literal notranslate"><span class="pre">CheckpointManager.evaluate_criteria()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.checkpoints.CheckpointManager.load"><code class="docutils literal notranslate"><span class="pre">CheckpointManager.load()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.checkpoints.CheckpointManager.register"><code class="docutils literal notranslate"><span class="pre">CheckpointManager.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.checkpoints.CheckpointManager.resume"><code class="docutils literal notranslate"><span class="pre">CheckpointManager.resume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.checkpoints.CheckpointManager.save"><code class="docutils literal notranslate"><span class="pre">CheckpointManager.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-congrads.constraints">Constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#congrads.constraints.BinaryConstraint"><code class="docutils literal notranslate"><span class="pre">BinaryConstraint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.BinaryConstraint.calculate_direction"><code class="docutils literal notranslate"><span class="pre">BinaryConstraint.calculate_direction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.BinaryConstraint.check_constraint"><code class="docutils literal notranslate"><span class="pre">BinaryConstraint.check_constraint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.constraints.Constraint"><code class="docutils literal notranslate"><span class="pre">Constraint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.Constraint.calculate_direction"><code class="docutils literal notranslate"><span class="pre">Constraint.calculate_direction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.Constraint.check_constraint"><code class="docutils literal notranslate"><span class="pre">Constraint.check_constraint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.Constraint.descriptor"><code class="docutils literal notranslate"><span class="pre">Constraint.descriptor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.Constraint.device"><code class="docutils literal notranslate"><span class="pre">Constraint.device</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.constraints.ImplicationConstraint"><code class="docutils literal notranslate"><span class="pre">ImplicationConstraint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.ImplicationConstraint.calculate_direction"><code class="docutils literal notranslate"><span class="pre">ImplicationConstraint.calculate_direction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.ImplicationConstraint.check_constraint"><code class="docutils literal notranslate"><span class="pre">ImplicationConstraint.check_constraint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.constraints.PythagoreanIdentityConstraint"><code class="docutils literal notranslate"><span class="pre">PythagoreanIdentityConstraint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.PythagoreanIdentityConstraint.calculate_direction"><code class="docutils literal notranslate"><span class="pre">PythagoreanIdentityConstraint.calculate_direction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.PythagoreanIdentityConstraint.check_constraint"><code class="docutils literal notranslate"><span class="pre">PythagoreanIdentityConstraint.check_constraint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.constraints.ScalarConstraint"><code class="docutils literal notranslate"><span class="pre">ScalarConstraint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.ScalarConstraint.calculate_direction"><code class="docutils literal notranslate"><span class="pre">ScalarConstraint.calculate_direction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.ScalarConstraint.check_constraint"><code class="docutils literal notranslate"><span class="pre">ScalarConstraint.check_constraint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.constraints.SumConstraint"><code class="docutils literal notranslate"><span class="pre">SumConstraint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.SumConstraint.calculate_direction"><code class="docutils literal notranslate"><span class="pre">SumConstraint.calculate_direction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.constraints.SumConstraint.check_constraint"><code class="docutils literal notranslate"><span class="pre">SumConstraint.check_constraint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-congrads.core">Core</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#congrads.core.CongradsCore"><code class="docutils literal notranslate"><span class="pre">CongradsCore</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.core.CongradsCore.fit"><code class="docutils literal notranslate"><span class="pre">CongradsCore.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.core.CongradsCore.test_step"><code class="docutils literal notranslate"><span class="pre">CongradsCore.test_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.core.CongradsCore.train_step"><code class="docutils literal notranslate"><span class="pre">CongradsCore.train_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.core.CongradsCore.valid_step"><code class="docutils literal notranslate"><span class="pre">CongradsCore.valid_step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-congrads.datasets">Datasets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#congrads.datasets.BiasCorrection"><code class="docutils literal notranslate"><span class="pre">BiasCorrection</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.datasets.BiasCorrection.data_folder"><code class="docutils literal notranslate"><span class="pre">BiasCorrection.data_folder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.datasets.BiasCorrection.download"><code class="docutils literal notranslate"><span class="pre">BiasCorrection.download()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.datasets.BiasCorrection.mirrors"><code class="docutils literal notranslate"><span class="pre">BiasCorrection.mirrors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.datasets.BiasCorrection.resources"><code class="docutils literal notranslate"><span class="pre">BiasCorrection.resources</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.datasets.FamilyIncome"><code class="docutils literal notranslate"><span class="pre">FamilyIncome</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.datasets.FamilyIncome.data_folder"><code class="docutils literal notranslate"><span class="pre">FamilyIncome.data_folder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.datasets.FamilyIncome.download"><code class="docutils literal notranslate"><span class="pre">FamilyIncome.download()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.datasets.FamilyIncome.mirrors"><code class="docutils literal notranslate"><span class="pre">FamilyIncome.mirrors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.datasets.FamilyIncome.resources"><code class="docutils literal notranslate"><span class="pre">FamilyIncome.resources</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.datasets.NoisySines"><code class="docutils literal notranslate"><span class="pre">NoisySines</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-congrads.descriptor">Descriptor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#congrads.descriptor.Descriptor"><code class="docutils literal notranslate"><span class="pre">Descriptor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.descriptor.Descriptor.neuron_to_layer"><code class="docutils literal notranslate"><span class="pre">Descriptor.neuron_to_layer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.descriptor.Descriptor.neuron_to_index"><code class="docutils literal notranslate"><span class="pre">Descriptor.neuron_to_index</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.descriptor.Descriptor.constant_layers"><code class="docutils literal notranslate"><span class="pre">Descriptor.constant_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.descriptor.Descriptor.variable_layers"><code class="docutils literal notranslate"><span class="pre">Descriptor.variable_layers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.descriptor.Descriptor.add"><code class="docutils literal notranslate"><span class="pre">Descriptor.add()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-congrads.metrics">Metrics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#congrads.metrics.Metric"><code class="docutils literal notranslate"><span class="pre">Metric</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.Metric.name"><code class="docutils literal notranslate"><span class="pre">Metric.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.Metric.accumulator"><code class="docutils literal notranslate"><span class="pre">Metric.accumulator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.Metric.values"><code class="docutils literal notranslate"><span class="pre">Metric.values</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.Metric.sample_count"><code class="docutils literal notranslate"><span class="pre">Metric.sample_count</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.Metric.accumulate"><code class="docutils literal notranslate"><span class="pre">Metric.accumulate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.Metric.aggregate"><code class="docutils literal notranslate"><span class="pre">Metric.aggregate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.Metric.reset"><code class="docutils literal notranslate"><span class="pre">Metric.reset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.metrics.MetricManager"><code class="docutils literal notranslate"><span class="pre">MetricManager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.MetricManager.metrics"><code class="docutils literal notranslate"><span class="pre">MetricManager.metrics</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.MetricManager.groups"><code class="docutils literal notranslate"><span class="pre">MetricManager.groups</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.MetricManager.accumulate"><code class="docutils literal notranslate"><span class="pre">MetricManager.accumulate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.MetricManager.aggregate"><code class="docutils literal notranslate"><span class="pre">MetricManager.aggregate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.MetricManager.register"><code class="docutils literal notranslate"><span class="pre">MetricManager.register()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.metrics.MetricManager.reset"><code class="docutils literal notranslate"><span class="pre">MetricManager.reset()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-congrads.networks">Networks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#congrads.networks.MLPNetwork"><code class="docutils literal notranslate"><span class="pre">MLPNetwork</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.networks.MLPNetwork.forward"><code class="docutils literal notranslate"><span class="pre">MLPNetwork.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.networks.MLPNetwork.linear"><code class="docutils literal notranslate"><span class="pre">MLPNetwork.linear()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-congrads.transformations">Transformations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#congrads.transformations.DenormalizeMinMax"><code class="docutils literal notranslate"><span class="pre">DenormalizeMinMax</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.transformations.IdentityTransformation"><code class="docutils literal notranslate"><span class="pre">IdentityTransformation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.transformations.Transformation"><code class="docutils literal notranslate"><span class="pre">Transformation</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-congrads.utils">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#congrads.utils.CSVLogger"><code class="docutils literal notranslate"><span class="pre">CSVLogger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#congrads.utils.CSVLogger.add_value"><code class="docutils literal notranslate"><span class="pre">CSVLogger.add_value()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.utils.CSVLogger.load"><code class="docutils literal notranslate"><span class="pre">CSVLogger.load()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.utils.CSVLogger.save"><code class="docutils literal notranslate"><span class="pre">CSVLogger.save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.utils.CSVLogger.to_dataframe"><code class="docutils literal notranslate"><span class="pre">CSVLogger.to_dataframe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#congrads.utils.CSVLogger.to_dict"><code class="docutils literal notranslate"><span class="pre">CSVLogger.to_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.utils.preprocess_BiasCorrection"><code class="docutils literal notranslate"><span class="pre">preprocess_BiasCorrection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.utils.preprocess_FamilyIncome"><code class="docutils literal notranslate"><span class="pre">preprocess_FamilyIncome()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.utils.split_data_loaders"><code class="docutils literal notranslate"><span class="pre">split_data_loaders()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.utils.validate_callable"><code class="docutils literal notranslate"><span class="pre">validate_callable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.utils.validate_comparator_pytorch"><code class="docutils literal notranslate"><span class="pre">validate_comparator_pytorch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.utils.validate_iterable"><code class="docutils literal notranslate"><span class="pre">validate_iterable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.utils.validate_loaders"><code class="docutils literal notranslate"><span class="pre">validate_loaders()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#congrads.utils.validate_type"><code class="docutils literal notranslate"><span class="pre">validate_type()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #cc5353" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Congrads</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-documentation">
<span id="api"></span><h1>API documentation<a class="headerlink" href="#api-documentation" title="Link to this heading"></a></h1>
<section id="module-congrads.checkpoints">
<span id="checkpoints"></span><h2>Checkpoints<a class="headerlink" href="#module-congrads.checkpoints" title="Link to this heading"></a></h2>
<p>This module provides a <cite>CheckpointManager</cite> class for managing the saving and
loading of checkpoints during PyTorch model training.</p>
<p>The <cite>CheckpointManager</cite> handles:</p>
<ul class="simple">
<li><p>Saving and loading the state of models, optimizers, and metrics.</p></li>
<li><p>Registering and evaluating performance criteria to determine if a model’s
performance has improved, enabling automated saving of the best-performing
model checkpoints.</p></li>
<li><p>Resuming training from a specific checkpoint.</p></li>
</ul>
<dl class="simple">
<dt>Usage:</dt><dd><ol class="arabic simple">
<li><p>Initialize the <cite>CheckpointManager</cite> with a PyTorch model, optimizer,
and metric manager.</p></li>
<li><p>Register criteria for tracking and evaluating metrics.</p></li>
<li><p>Use the <cite>save</cite> and <cite>load</cite> methods to manage checkpoints during training.</p></li>
<li><p>Call <cite>evaluate_criteria</cite> to automatically evaluate and save the
best-performing checkpoints.</p></li>
</ol>
</dd>
<dt>Dependencies:</dt><dd><ul class="simple">
<li><p>PyTorch (<cite>torch</cite>)</p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="congrads.checkpoints.CheckpointManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.checkpoints.</span></span><span class="sig-name descname"><span class="pre">CheckpointManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><span class="pre">Module</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.6)"><span class="pre">Optimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#congrads.metrics.MetricManager" title="congrads.metrics.MetricManager"><span class="pre">MetricManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'checkpoints'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">create_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.checkpoints.CheckpointManager" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class to handle saving and loading checkpoints for
PyTorch models and optimizers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><em>torch.nn.Module</em></a>) – The network (model) to save/load.</p></li>
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.6)"><em>torch.optim.Optimizer</em></a>) – The optimizer to save/load.</p></li>
<li><p><strong>metric_manager</strong> (<a class="reference internal" href="#congrads.metrics.MetricManager" title="congrads.metrics.MetricManager"><em>MetricManager</em></a>) – The metric manager to restore saved
metric states.</p></li>
<li><p><strong>save_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Directory where checkpoints will be saved. Defaults
to ‘checkpoints’.</p></li>
<li><p><strong>create_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to create the save_dir if it does not exist.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the save directory does not exist and create_dir
    is set to False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.checkpoints.CheckpointManager.evaluate_criteria">
<span class="sig-name descname"><span class="pre">evaluate_criteria</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.checkpoints.CheckpointManager.evaluate_criteria" title="Link to this definition"></a></dt>
<dd><p>Evaluate the defined criteria for model performance metrics
during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The current epoch number.</p>
</dd>
</dl>
<p>Compares the current metrics against the previous best metrics using
predefined comparators. If a criterion is met, saves the model and
the corresponding best metric values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.checkpoints.CheckpointManager.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.checkpoints.CheckpointManager.load" title="Link to this definition"></a></dt>
<dd><p>Load a checkpoint and restores the state of the network, optimizer
and best_metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the checkpoint file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the loaded checkpoint
information (epoch, loss, etc.).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.checkpoints.CheckpointManager.register">
<span class="sig-name descname"><span class="pre">register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">metric_name:</span> <span class="pre">str,</span> <span class="pre">comparator:</span> <span class="pre">~typing.Callable[[~torch.Tensor,</span> <span class="pre">~torch.Tensor],</span> <span class="pre">~torch.Tensor]</span> <span class="pre">=</span> <span class="pre">&lt;built-in</span> <span class="pre">method</span> <span class="pre">gt</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.checkpoints.CheckpointManager.register" title="Link to this definition"></a></dt>
<dd><p>Register a criterion for evaluating a performance metric
during training.</p>
<p>Stores the comparator to determine whether the current metric has
improved relative to the previous best metric value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the metric to evaluate.</p></li>
<li><p><strong>comparator</strong> (<em>Callable</em><em>[</em><em>[</em><em>Tensor</em><em>, </em><em>Tensor</em><em>]</em><em>, </em><em>Tensor</em><em>]</em><em>, </em><em>optional</em>) – A function that compares the current metric value against the
previous best value. Defaults to a greater-than (gt) comparison.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.checkpoints.CheckpointManager.resume">
<span class="sig-name descname"><span class="pre">resume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'checkpoint.pth'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_missing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></span><a class="headerlink" href="#congrads.checkpoints.CheckpointManager.resume" title="Link to this definition"></a></dt>
<dd><p>Resumes training from a saved checkpoint file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the checkpoint file to load.
Defaults to “checkpoint.pth”.</p></li>
<li><p><strong>ignore_missing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, does not raise an error if the
checkpoint file is missing and continues without loading,
starting from epoch 0. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The epoch number from the loaded checkpoint, or 0 if</dt><dd><p>ignore_missing is True and no checkpoint was found.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If the specified checkpoint file does not exist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.checkpoints.CheckpointManager.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'checkpoint.pth'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.checkpoints.CheckpointManager.save" title="Link to this definition"></a></dt>
<dd><p>Save a checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Current epoch number.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the checkpoint file. Defaults to
‘checkpoint.pth’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-congrads.constraints">
<span id="constraints"></span><h2>Constraints<a class="headerlink" href="#module-congrads.constraints" title="Link to this heading"></a></h2>
<p>This module provides a set of constraint classes for guiding neural network
training by enforcing specific conditions on the network’s outputs.</p>
<p>The constraints in this module include:</p>
<ul class="simple">
<li><p><cite>Constraint</cite>: The base class for all constraint types, defining the
interface and core behavior.</p></li>
<li><p><cite>ImplicationConstraint</cite>: A constraint that enforces one condition only if
another condition is met, useful for modeling implications between network
outputs.</p></li>
<li><p><cite>ScalarConstraint</cite>: A constraint that enforces scalar-based comparisons on
a network’s output.</p></li>
<li><p><cite>BinaryConstraint</cite>: A constraint that enforces a binary comparison between
two neurons in the network, using a comparison function (e.g., less than,
greater than).</p></li>
<li><p><cite>SumConstraint</cite>: A constraint that enforces that the sum of certain neurons’
outputs equals a specified value, which can be used to control total output.</p></li>
<li><p><cite>PythagoreanConstraint</cite>: A constraint that enforces the Pythagorean theorem
on a set of neurons, ensuring that the square of one neuron’s output is equal
to the sum of the squares of other outputs.</p></li>
</ul>
<p>These constraints can be used to steer the learning process by applying
conditions such as logical implications or numerical bounds.</p>
<dl class="simple">
<dt>Usage:</dt><dd><ol class="arabic simple">
<li><p>Define a custom constraint class by inheriting from <cite>Constraint</cite>.</p></li>
<li><p>Apply the constraint to your neural network during training to
enforce desired output behaviors.</p></li>
<li><p>Use the helper classes like <cite>IdentityTransformation</cite> for handling
transformations and comparisons in constraints.</p></li>
</ol>
</dd>
<dt>Dependencies:</dt><dd><ul class="simple">
<li><p>PyTorch (<cite>torch</cite>)</p></li>
</ul>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="congrads.constraints.BinaryConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.constraints.</span></span><span class="sig-name descname"><span class="pre">BinaryConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operand_left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><span class="pre">Transformation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operand_right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><span class="pre">Transformation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.constraints.BinaryConstraint" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a></p>
<p>A constraint that enforces a binary comparison between two neurons.</p>
<p>This class ensures that the output of one neuron satisfies a comparison
operation with the output of another neuron
(e.g., less than, greater than, etc.). It uses a comparator function to
validate the condition and calculates adjustment directions accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>operand_left</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><em>Transformation</em></a><em>]</em>) – Name of the left
neuron or a transformation to apply.</p></li>
<li><p><strong>comparator</strong> (<em>Callable</em><em>[</em><em>[</em><em>Tensor</em><em>, </em><em>Number</em><em>]</em><em>, </em><em>Tensor</em><em>]</em>) – A comparison
function (e.g., <cite>torch.ge</cite>, <cite>torch.lt</cite>).</p></li>
<li><p><strong>operand_right</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><em>Transformation</em></a><em>]</em>) – Name of the right
neuron or a transformation to apply.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A unique name for the constraint. If not
provided, a name is auto-generated in the format
“&lt;neuron_name_left&gt; &lt;comparator&gt; &lt;neuron_name_right&gt;”.</p></li>
<li><p><strong>monitor_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, only monitor the constraint
without adjusting the loss. Defaults to False.</p></li>
<li><p><strong>rescale_factor</strong> (<em>Number</em><em>, </em><em>optional</em>) – Factor to scale the
constraint-adjusted loss. Defaults to 1.5.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The neuron names must be defined in the <cite>descriptor</cite> mapping.</p></li>
<li><p>The constraint name is composed using the left neuron name,
comparator, and right neuron name.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.BinaryConstraint.calculate_direction">
<span class="sig-name descname"><span class="pre">calculate_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.BinaryConstraint.calculate_direction" title="Link to this definition"></a></dt>
<dd><p>Calculates adjustment directions for neurons to
better satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping neuron layers to tensors
specifying the adjustment direction for each neuron.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Tensor]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.BinaryConstraint.check_constraint">
<span class="sig-name descname"><span class="pre">check_constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.BinaryConstraint.check_constraint" title="Link to this definition"></a></dt>
<dd><p>Evaluates whether the given model predictions satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple where the first element is a tensor
indicating whether the constraint is satisfied (with <cite>True</cite>
for satisfaction, <cite>False</cite> for non-satisfaction, and <cite>torch.nan</cite>
for irrelevant results), and the second element is an integer
value representing the number of relevant constraints.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[Tensor, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.constraints.Constraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.constraints.</span></span><span class="sig-name descname"><span class="pre">Constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neurons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.constraints.Constraint" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract base class for defining constraints applied to neural networks.</p>
<p>A <cite>Constraint</cite> specifies conditions that the neural network outputs
should satisfy. It supports monitoring constraint satisfaction
during training and can adjust loss to enforce constraints. Subclasses
must implement the <cite>check_constraint</cite> and <cite>calculate_direction</cite> methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neurons</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><em>set</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – Names of the neurons this constraint applies to.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A unique name for the constraint. If not provided,
a name is generated based on the class name and a random suffix.</p></li>
<li><p><strong>monitor_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, only monitor the constraint
without adjusting the loss. Defaults to False.</p></li>
<li><p><strong>rescale_factor</strong> (<em>Number</em><em>, </em><em>optional</em>) – Factor to scale the
constraint-adjusted loss. Defaults to 1.5. Should be greater
than 1 to give weight to the constraint.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If any neuron in <cite>neurons</cite> is not
    defined in the <cite>descriptor</cite>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If <cite>rescale_factor &lt;= 1</cite>, a warning is issued, and the value is
adjusted to a positive value greater than 1.</p></li>
<li><p>If <cite>name</cite> is not provided, a name is auto-generated,
and a warning is logged.</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.Constraint.calculate_direction">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.Constraint.calculate_direction" title="Link to this definition"></a></dt>
<dd><p>Calculates adjustment directions for neurons to
better satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping neuron layers to tensors
specifying the adjustment direction for each neuron.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Tensor]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.Constraint.check_constraint">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">check_constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.Constraint.check_constraint" title="Link to this definition"></a></dt>
<dd><p>Evaluates whether the given model predictions satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple where the first element is a tensor
indicating whether the constraint is satisfied (with <cite>True</cite>
for satisfaction, <cite>False</cite> for non-satisfaction, and <cite>torch.nan</cite>
for irrelevant results), and the second element is an integer
value representing the number of relevant constraints.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[Tensor, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.constraints.Constraint.descriptor">
<span class="sig-name descname"><span class="pre">descriptor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#congrads.descriptor.Descriptor" title="congrads.descriptor.Descriptor"><span class="pre">Descriptor</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#congrads.constraints.Constraint.descriptor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.constraints.Constraint.device">
<span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#congrads.constraints.Constraint.device" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.constraints.ImplicationConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.constraints.</span></span><span class="sig-name descname"><span class="pre">ImplicationConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">head</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><span class="pre">Constraint</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">body</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><span class="pre">Constraint</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.constraints.ImplicationConstraint" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a></p>
<p>Represents an implication constraint between two
constraints (head and body).</p>
<p>The implication constraint ensures that the <cite>body</cite> constraint only applies
when the <cite>head</cite> constraint is satisfied. If the <cite>head</cite> constraint is not
satisfied, the <cite>body</cite> constraint does not apply.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>head</strong> (<a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><em>Constraint</em></a>) – The head of the implication. If this constraint
is satisfied, the body constraint must also be satisfied.</p></li>
<li><p><strong>body</strong> (<a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><em>Constraint</em></a>) – The body of the implication. This constraint
is enforced only when the head constraint is satisfied.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A unique name for the constraint. If not
provided, the name is generated in the format
“{body.name} if {head.name}”. Defaults to None.</p></li>
<li><p><strong>monitor_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, the constraint is only
monitored without adjusting the loss. Defaults to False.</p></li>
<li><p><strong>rescale_factor</strong> (<em>Number</em><em>, </em><em>optional</em>) – The scaling factor for the
constraint-adjusted loss. Defaults to 1.5.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.ImplicationConstraint.calculate_direction">
<span class="sig-name descname"><span class="pre">calculate_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.ImplicationConstraint.calculate_direction" title="Link to this definition"></a></dt>
<dd><p>Calculates adjustment directions for neurons to
better satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping neuron layers to tensors
specifying the adjustment direction for each neuron.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Tensor]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.ImplicationConstraint.check_constraint">
<span class="sig-name descname"><span class="pre">check_constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.ImplicationConstraint.check_constraint" title="Link to this definition"></a></dt>
<dd><p>Evaluates whether the given model predictions satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple where the first element is a tensor
indicating whether the constraint is satisfied (with <cite>True</cite>
for satisfaction, <cite>False</cite> for non-satisfaction, and <cite>torch.nan</cite>
for irrelevant results), and the second element is an integer
value representing the number of relevant constraints.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[Tensor, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.constraints.PythagoreanIdentityConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.constraints.</span></span><span class="sig-name descname"><span class="pre">PythagoreanIdentityConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><span class="pre">Transformation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><span class="pre">Transformation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.constraints.PythagoreanIdentityConstraint" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a></p>
<p>A constraint that enforces the Pythagorean identity: a² + b² ≈ 1,
where <cite>a</cite> and <cite>b</cite> are neurons or transformations.</p>
<p>This constraint checks that the sum of the squares of two specified
neurons (or their transformations) is approximately equal to 1.
The constraint is evaluated using relative and absolute
tolerance (<cite>rtol</cite> and <cite>atol</cite>) and is applied during the forward pass.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><em>Transformation</em></a><em>]</em>) – The first input, either a
neuron name (str) or a Transformation.</p></li>
<li><p><strong>b</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><em>Transformation</em></a><em>]</em>) – The second input, either a
neuron name (str) or a Transformation.</p></li>
<li><p><strong>rtol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The relative tolerance for the
comparison (default is 0.00001).</p></li>
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – The absolute tolerance for the
comparison (default is 1e-8).</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the constraint
(default is None, and it is generated automatically).</p></li>
<li><p><strong>monitor_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Flag indicating whether the
constraint is only for monitoring (default is False).</p></li>
<li><p><strong>rescale_factor</strong> (<em>Number</em><em>, </em><em>optional</em>) – A factor used for
rescaling (default is 1.5).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.PythagoreanIdentityConstraint.calculate_direction">
<span class="sig-name descname"><span class="pre">calculate_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.PythagoreanIdentityConstraint.calculate_direction" title="Link to this definition"></a></dt>
<dd><p>Calculates adjustment directions for neurons to
better satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping neuron layers to tensors
specifying the adjustment direction for each neuron.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Tensor]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.PythagoreanIdentityConstraint.check_constraint">
<span class="sig-name descname"><span class="pre">check_constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.PythagoreanIdentityConstraint.check_constraint" title="Link to this definition"></a></dt>
<dd><p>Evaluates whether the given model predictions satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple where the first element is a tensor
indicating whether the constraint is satisfied (with <cite>True</cite>
for satisfaction, <cite>False</cite> for non-satisfaction, and <cite>torch.nan</cite>
for irrelevant results), and the second element is an integer
value representing the number of relevant constraints.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[Tensor, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.constraints.ScalarConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.constraints.</span></span><span class="sig-name descname"><span class="pre">ScalarConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><span class="pre">Transformation</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.constraints.ScalarConstraint" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a></p>
<p>A constraint that enforces scalar-based comparisons on a specific neuron.</p>
<p>This class ensures that the output of a specified neuron satisfies a scalar
comparison operation (e.g., less than, greater than, etc.). It uses a
comparator function to validate the condition and calculates adjustment
directions accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>operand</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><em>Transformation</em></a><em>]</em>) – Name of the neuron or a
transformation to apply.</p></li>
<li><p><strong>comparator</strong> (<em>Callable</em><em>[</em><em>[</em><em>Tensor</em><em>, </em><em>Number</em><em>]</em><em>, </em><em>Tensor</em><em>]</em>) – A comparison
function (e.g., <cite>torch.ge</cite>, <cite>torch.lt</cite>).</p></li>
<li><p><strong>scalar</strong> (<em>Number</em>) – The scalar value to compare against.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – A unique name for the constraint. If not
provided, a name is auto-generated in the format
“&lt;neuron_name&gt; &lt;comparator&gt; &lt;scalar&gt;”.</p></li>
<li><p><strong>monitor_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, only monitor the constraint
without adjusting the loss. Defaults to False.</p></li>
<li><p><strong>rescale_factor</strong> (<em>Number</em><em>, </em><em>optional</em>) – Factor to scale the
constraint-adjusted loss. Defaults to 1.5.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The <cite>neuron_name</cite> must be defined in the <cite>descriptor</cite> mapping.</p></li>
<li><p>The constraint name is composed using the neuron name,
comparator, and scalar value.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.ScalarConstraint.calculate_direction">
<span class="sig-name descname"><span class="pre">calculate_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.ScalarConstraint.calculate_direction" title="Link to this definition"></a></dt>
<dd><p>Calculates adjustment directions for neurons to
better satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping neuron layers to tensors
specifying the adjustment direction for each neuron.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Tensor]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.ScalarConstraint.check_constraint">
<span class="sig-name descname"><span class="pre">check_constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.ScalarConstraint.check_constraint" title="Link to this definition"></a></dt>
<dd><p>Evaluates whether the given model predictions satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple where the first element is a tensor
indicating whether the constraint is satisfied (with <cite>True</cite>
for satisfaction, <cite>False</cite> for non-satisfaction, and <cite>torch.nan</cite>
for irrelevant results), and the second element is an integer
value representing the number of relevant constraints.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[Tensor, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.constraints.SumConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.constraints.</span></span><span class="sig-name descname"><span class="pre">SumConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operands_left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><span class="pre">Transformation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operands_right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><span class="pre">Transformation</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_left</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_right</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.constraints.SumConstraint" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Constraint</span></code></a></p>
<p>A constraint that enforces a weighted summation comparison
between two groups of neurons.</p>
<p>This class evaluates whether the weighted sum of outputs from one set of
neurons satisfies a comparison operation with the weighted sum of
outputs from another set of neurons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>operands_left</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><em>Transformation</em></a><em>]</em><em>]</em>) – List of neuron
names or transformations on the left side.</p></li>
<li><p><strong>comparator</strong> (<em>Callable</em><em>[</em><em>[</em><em>Tensor</em><em>, </em><em>Number</em><em>]</em><em>, </em><em>Tensor</em><em>]</em>) – A comparison
function for the constraint.</p></li>
<li><p><strong>operands_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><em>Transformation</em></a><em>]</em><em>]</em>) – List of neuron
names or transformations on the right side.</p></li>
<li><p><strong>weights_left</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>Number</em><em>]</em><em>, </em><em>optional</em>) – Weights for the left neurons.
Defaults to None.</p></li>
<li><p><strong>weights_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>Number</em><em>]</em><em>, </em><em>optional</em>) – Weights for the right
neurons. Defaults to None.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>optional</em>) – Unique name for the constraint.
If None, it’s auto-generated. Defaults to None.</p></li>
<li><p><strong>monitor_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, only monitor the constraint
without adjusting the loss. Defaults to False.</p></li>
<li><p><strong>rescale_factor</strong> (<em>Number</em><em>, </em><em>optional</em>) – Factor to scale the
constraint-adjusted loss. Defaults to 1.5.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the dimensions of neuron names and weights mismatch.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.SumConstraint.calculate_direction">
<span class="sig-name descname"><span class="pre">calculate_direction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><span class="pre">Dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.SumConstraint.calculate_direction" title="Link to this definition"></a></dt>
<dd><p>Calculates adjustment directions for neurons to
better satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary mapping neuron layers to tensors
specifying the adjustment direction for each neuron.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Tensor]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.constraints.SumConstraint.check_constraint">
<span class="sig-name descname"><span class="pre">check_constraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.constraints.SumConstraint.check_constraint" title="Link to this definition"></a></dt>
<dd><p>Evaluates whether the given model predictions satisfy the constraint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for the neurons.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple where the first element is a tensor
indicating whether the constraint is satisfied (with <cite>True</cite>
for satisfaction, <cite>False</cite> for non-satisfaction, and <cite>torch.nan</cite>
for irrelevant results), and the second element is an integer
value representing the number of relevant constraints.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[Tensor, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.13)"><strong>NotImplementedError</strong></a> – If not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-congrads.core">
<span id="core"></span><h2>Core<a class="headerlink" href="#module-congrads.core" title="Link to this heading"></a></h2>
<p>This module provides the CongradsCore class, which is designed to integrate
constraint-guided optimization into neural network training.
It extends traditional training processes by enforcing specific constraints
on the model’s outputs, ensuring that the network satisfies domain-specific
requirements during both training and evaluation.</p>
<p>The <cite>CongradsCore</cite> class serves as the central engine for managing the
training, validation, and testing phases of a neural network model,
incorporating constraints that influence the loss function and model updates.
The model is trained with standard loss functions while also incorporating
constraint-based adjustments, which are tracked and logged
throughout the process.</p>
<p>Key features:
- Support for various constraints that can influence the training process.
- Integration with PyTorch’s <cite>DataLoader</cite> for efficient batch processing.
- Metric management for tracking loss and constraint satisfaction.
- Checkpoint management for saving and evaluating model states.</p>
<p>Modules in this package provide the following:</p>
<ul class="simple">
<li><p><cite>Descriptor</cite>: Describes variable layers in the network that are
subject to constraints.</p></li>
<li><p><cite>Constraint</cite>: Defines various constraints, which are used to guide
the training process.</p></li>
<li><p><cite>MetricManager</cite>: Manages and tracks performance metrics such as loss
and constraint satisfaction.</p></li>
<li><p><cite>CheckpointManager</cite>: Manages saving and loading model checkpoints
during training.</p></li>
<li><p>Utility functions to validate inputs and configurations.</p></li>
</ul>
<dl class="simple">
<dt>Dependencies:</dt><dd><ul class="simple">
<li><p>PyTorch (<cite>torch</cite>)</p></li>
<li><p>tqdm (for progress tracking)</p></li>
</ul>
</dd>
</dl>
<p>The <cite>CongradsCore</cite> class allows for the use of additional callback functions
at different stages of the training process to customize behavior for
specific needs. These include callbacks for the start and end of epochs, as
well as the start and end of the entire training process.</p>
<dl class="py class">
<dt class="sig sig-object py" id="congrads.core.CongradsCore">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.core.</span></span><span class="sig-name descname"><span class="pre">CongradsCore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#congrads.descriptor.Descriptor" title="congrads.descriptor.Descriptor"><span class="pre">Descriptor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><span class="pre">Constraint</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loaders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.6)"><span class="pre">DataLoader</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.6)"><span class="pre">DataLoader</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.6)"><span class="pre">DataLoader</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><span class="pre">Module</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">_Loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.6)"><span class="pre">Optimizer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#congrads.metrics.MetricManager" title="congrads.metrics.MetricManager"><span class="pre">MetricManager</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><span class="pre">device</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_manager</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#congrads.checkpoints.CheckpointManager" title="congrads.checkpoints.CheckpointManager"><span class="pre">CheckpointManager</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.core.CongradsCore" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>The CongradsCore class is the central training engine for constraint-guided
neural network optimization. It integrates standard neural network training
with additional constraint-driven adjustments to the loss function, ensuring
that the network satisfies domain-specific constraints during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>descriptor</strong> (<a class="reference internal" href="#congrads.descriptor.Descriptor" title="congrads.descriptor.Descriptor"><em>Descriptor</em></a>) – Describes variable layers in the network.</p></li>
<li><p><strong>constraints</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="#congrads.constraints.Constraint" title="congrads.constraints.Constraint"><em>Constraint</em></a><em>]</em>) – List of constraints to guide training.</p></li>
<li><p><strong>loaders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><em>DataLoader</em><em>, </em><em>DataLoader</em><em>, </em><em>DataLoader</em><em>]</em>) – DataLoaders for
training, validation, and testing.</p></li>
<li><p><strong>network</strong> (<em>Module</em>) – The neural network model to train.</p></li>
<li><p><strong>criterion</strong> (<em>callable</em>) – The loss function used for
training and validation.</p></li>
<li><p><strong>optimizer</strong> (<em>Optimizer</em>) – The optimizer used for updating model parameters.</p></li>
<li><p><strong>metric_manager</strong> (<a class="reference internal" href="#congrads.metrics.MetricManager" title="congrads.metrics.MetricManager"><em>MetricManager</em></a>) – Manages metric tracking and recording.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.6)"><em>torch.device</em></a>) – The device (e.g., CPU or GPU) for computations.</p></li>
<li><p><strong>checkpoint_manager</strong> (<a class="reference internal" href="#congrads.checkpoints.CheckpointManager" title="congrads.checkpoints.CheckpointManager"><em>CheckpointManager</em></a><em>, </em><em>optional</em>) – Manages
checkpointing. If not set, no checkpointing is done.</p></li>
<li><p><strong>epsilon</strong> (<em>Number</em><em>, </em><em>optional</em>) – A small value to avoid division by zero
in gradient calculations. Default is 1e-10.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A warning is logged if the descriptor has no variable layers,
as at least one variable layer is required for the constraint logic
to influence the training process.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.core.CongradsCore.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_epoch_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_epoch_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_train_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on_train_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#congrads.core.CongradsCore.fit" title="Link to this definition"></a></dt>
<dd><p>Train the model for a given number of epochs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The epoch number to start the training
with. Default is 0.</p></li>
<li><p><strong>max_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The number of epochs to train the
model. Default is 100.</p></li>
<li><p><strong>on_epoch_start</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – A callback
function that will be executed at the start of each epoch.</p></li>
<li><p><strong>on_epoch_end</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – A callback
function that will be executed at the end of each epoch.</p></li>
<li><p><strong>on_train_start</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – A callback
function that will be executed before the training starts.</p></li>
<li><p><strong>on_train_end</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – A callback
function that will be executed after training ends.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.core.CongradsCore.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></span><a class="headerlink" href="#congrads.core.CongradsCore.test_step" title="Link to this definition"></a></dt>
<dd><p>Evaluate constraints during test and log satisfaction metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions
for variable layers.</p></li>
<li><p><strong>loss</strong> (<em>Tensor</em>) – The base loss computed by the criterion.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The unchanged base loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.core.CongradsCore.train_step">
<span class="sig-name descname"><span class="pre">train_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></span><a class="headerlink" href="#congrads.core.CongradsCore.train_step" title="Link to this definition"></a></dt>
<dd><p>Adjust the training loss based on constraints
and compute the combined loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions
for variable layers.</p></li>
<li><p><strong>loss</strong> (<em>Tensor</em>) – The base loss computed by the criterion.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The combined loss (base loss + constraint adjustments).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.core.CongradsCore.valid_step">
<span class="sig-name descname"><span class="pre">valid_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></span><a class="headerlink" href="#congrads.core.CongradsCore.valid_step" title="Link to this definition"></a></dt>
<dd><p>Evaluate constraints during validation and log satisfaction metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Tensor</em><em>]</em>) – Model predictions for
variable layers.</p></li>
<li><p><strong>loss</strong> (<em>Tensor</em>) – The base loss computed by the criterion.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The unchanged base loss.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-congrads.datasets">
<span id="datasets"></span><h2>Datasets<a class="headerlink" href="#module-congrads.datasets" title="Link to this heading"></a></h2>
<p>This module defines several PyTorch dataset classes for loading and
working with various datasets. Each dataset class extends the
<cite>torch.utils.data.Dataset</cite> class and provides functionality for
downloading, loading, and transforming specific datasets.</p>
<p>Classes:</p>
<blockquote>
<div><ul class="simple">
<li><p>BiasCorrection: A dataset class for the Bias Correction dataset
focused on temperature forecast data.</p></li>
<li><p>FamilyIncome: A dataset class for the Family Income and
Expenditure dataset.</p></li>
<li><p>NoisySines: A dataset class that generates noisy sine wave
samples with added Gaussian noise.</p></li>
</ul>
</div></blockquote>
<p>Each dataset class provides methods for downloading the data
(if not already available), checking the integrity of the dataset, loading
the data from CSV files or generating synthetic data, and applying
transformations to the data.</p>
<p>Key Methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>__init__</cite>: Initializes the dataset by specifying the root directory,
transformation function, and optional download flag.</p></li>
<li><p><cite>__getitem__</cite>: Retrieves a specific data point given its index,
returning input-output pairs.</p></li>
<li><p><cite>__len__</cite>: Returns the total number of examples in the dataset.</p></li>
<li><dl class="simple">
<dt><cite>download</cite>: Downloads and extracts the dataset from</dt><dd><p>the specified mirrors.</p>
</dd>
</dl>
</li>
<li><p><cite>_load_data</cite>: Loads the dataset from CSV files and
applies transformations.</p></li>
<li><p><cite>_check_exists</cite>: Checks if the dataset is already
downloaded and verified.</p></li>
</ul>
</div></blockquote>
<p>Each dataset class allows the user to apply custom transformations to the
dataset through the <cite>transform</cite> argument to allow pre-processing and offers
the ability to download the dataset if it’s not already present on
the local disk.</p>
<dl class="py class">
<dt class="sig sig-object py" id="congrads.datasets.BiasCorrection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.datasets.</span></span><span class="sig-name descname"><span class="pre">BiasCorrection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">download</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.datasets.BiasCorrection" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a></p>
<p>A dataset class for accessing the Bias Correction dataset.</p>
<p>This class extends the <cite>Dataset</cite> class and provides functionality for
downloading, loading, and transforming the Bias Correction dataset.
The dataset is focused on temperature forecast data and is made available
for use with PyTorch. If <cite>download</cite> is set to True, the dataset will be
downloaded if it is not already available. The data is then loaded,
and a transformation function is applied to it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Path</em><em>]</em>) – The root directory where the dataset
will be stored or loaded from.</p></li>
<li><p><strong>transform</strong> (<em>Callable</em>) – A function to transform the dataset
(e.g., preprocessing).</p></li>
<li><p><strong>download</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to download the dataset if it’s
not already present. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If the dataset is not found and <cite>download</cite>
    is not set to True or if all mirrors fail to provide the dataset.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="congrads.datasets.BiasCorrection.data_folder">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_folder</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#congrads.datasets.BiasCorrection.data_folder" title="Link to this definition"></a></dt>
<dd><p>Returns the path to the folder where the dataset is stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The path to the dataset folder.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.datasets.BiasCorrection.download">
<span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#congrads.datasets.BiasCorrection.download" title="Link to this definition"></a></dt>
<dd><p>Downloads and extracts the dataset.</p>
<p>This method attempts to download the dataset from the mirrors and
extract it into the appropriate folder. If any error occurs during
downloading, it will try each mirror in sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If all mirrors fail to provide the dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.datasets.BiasCorrection.mirrors">
<span class="sig-name descname"><span class="pre">mirrors</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['https://archive.ics.uci.edu/static/public/514/']</span></em><a class="headerlink" href="#congrads.datasets.BiasCorrection.mirrors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.datasets.BiasCorrection.resources">
<span class="sig-name descname"><span class="pre">resources</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[('bias+correction+of+numerical+prediction+model+temperature+forecast.zip',</span> <span class="pre">'3deee56d461a2686887c4ae38fe3ccf3')]</span></em><a class="headerlink" href="#congrads.datasets.BiasCorrection.resources" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.datasets.FamilyIncome">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.datasets.</span></span><span class="sig-name descname"><span class="pre">FamilyIncome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><span class="pre">Callable</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">download</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.datasets.FamilyIncome" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a></p>
<p>A dataset class for accessing the Family Income and Expenditure dataset.</p>
<p>This class extends the <cite>Dataset</cite> class and provides functionality for
downloading, loading, and transforming the Family Income and
Expenditure dataset. The dataset is intended for use with
PyTorch-based projects, offering a convenient interface for data handling.
This class provides access to the Family Income and Expenditure dataset
for use with PyTorch. If <cite>download</cite> is set to True, the dataset will be
downloaded if it is not already available. The data is then loaded,
and a user-defined transformation function is applied to it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Path</em><em>]</em>) – The root directory where the dataset will
be stored or loaded from.</p></li>
<li><p><strong>transform</strong> (<em>Callable</em>) – A function to transform the dataset
(e.g., preprocessing).</p></li>
<li><p><strong>download</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to download the dataset if it’s
not already present. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If the dataset is not found and <cite>download</cite>
    is not set to True or if all mirrors fail to provide the dataset.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="congrads.datasets.FamilyIncome.data_folder">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data_folder</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#congrads.datasets.FamilyIncome.data_folder" title="Link to this definition"></a></dt>
<dd><p>Returns the path to the folder where the dataset is stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The path to the dataset folder.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.datasets.FamilyIncome.download">
<span class="sig-name descname"><span class="pre">download</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#congrads.datasets.FamilyIncome.download" title="Link to this definition"></a></dt>
<dd><p>Downloads and extracts the dataset.</p>
<p>This method attempts to download the dataset from the mirrors
and extract it into the appropriate folder. If any error occurs
during downloading, it will try each mirror in sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If all mirrors fail to provide the dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.datasets.FamilyIncome.mirrors">
<span class="sig-name descname"><span class="pre">mirrors</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['https://www.kaggle.com/api/v1/datasets/download/grosvenpaul/family-income-and-expenditure']</span></em><a class="headerlink" href="#congrads.datasets.FamilyIncome.mirrors" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.datasets.FamilyIncome.resources">
<span class="sig-name descname"><span class="pre">resources</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[('archive.zip',</span> <span class="pre">'7d74bc7facc3d7c07c4df1c1c6ac563e')]</span></em><a class="headerlink" href="#congrads.datasets.FamilyIncome.resources" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.datasets.NoisySines">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.datasets.</span></span><span class="sig-name descname"><span class="pre">NoisySines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.datasets.NoisySines" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></a></p>
<p>A PyTorch dataset generating samples from a causal
sine wave with added noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – Number of data points in the dataset.</p></li>
<li><p><strong>amplitude</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Amplitude of the sine wave.</p></li>
<li><p><strong>frequency</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Frequency of the sine wave in Hz.</p></li>
<li><p><strong>noise_std</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Standard deviation of the Gaussian noise.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – Offset from zero.</p></li>
</ul>
</dd>
</dl>
<p>The sine wave is zero for times before t=0 and follows a
standard sine wave after t=0, with Gaussian noise added to all points.</p>
</dd></dl>

</section>
<section id="module-congrads.descriptor">
<span id="descriptor"></span><h2>Descriptor<a class="headerlink" href="#module-congrads.descriptor" title="Link to this heading"></a></h2>
<p>This module defines the <cite>Descriptor</cite> class, which is designed to manage
the mapping between neuron names, their corresponding layers, and additional
properties such as constant or variable status. It provides a way to easily
place constraints on parts of your network, by referencing the neuron names
instead of indices.</p>
<p>The <cite>Descriptor</cite> class allows for easy constraint definitions on parts of
your neural network. It supports registering neurons with associated layers,
indices, and optional attributes, such as whether the layer is constant
or variable.</p>
<p>Key Methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>__init__</cite>: Initializes the <cite>Descriptor</cite> object with empty mappings
and sets for managing neurons and layers.</p></li>
<li><p><cite>add</cite>: Registers a neuron with its associated layer, index, and
optional constant status.</p></li>
</ul>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="congrads.descriptor.Descriptor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.descriptor.</span></span><span class="sig-name descname"><span class="pre">Descriptor</span></span><a class="headerlink" href="#congrads.descriptor.Descriptor" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class to manage the mapping between neuron names, their corresponding
layers, and additional properties (such as min/max values, output,
and constant variables).</p>
<p>This class is designed to track the relationship between neurons and
layers in a neural network. It allows for the assignment of properties
(like minimum and maximum values, and whether a layer is an output,
constant, or variable) to each neuron. The data is stored in
dictionaries and sets for efficient lookups.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.descriptor.Descriptor.neuron_to_layer">
<span class="sig-name descname"><span class="pre">neuron_to_layer</span></span><a class="headerlink" href="#congrads.descriptor.Descriptor.neuron_to_layer" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping neuron names to
their corresponding layer names.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.descriptor.Descriptor.neuron_to_index">
<span class="sig-name descname"><span class="pre">neuron_to_index</span></span><a class="headerlink" href="#congrads.descriptor.Descriptor.neuron_to_index" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping neuron names to
their corresponding indices in the layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.descriptor.Descriptor.constant_layers">
<span class="sig-name descname"><span class="pre">constant_layers</span></span><a class="headerlink" href="#congrads.descriptor.Descriptor.constant_layers" title="Link to this definition"></a></dt>
<dd><p>A set of layer names that represent
constant layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)">set</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.descriptor.Descriptor.variable_layers">
<span class="sig-name descname"><span class="pre">variable_layers</span></span><a class="headerlink" href="#congrads.descriptor.Descriptor.variable_layers" title="Link to this definition"></a></dt>
<dd><p>A set of layer names that represent
variable layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)">set</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.descriptor.Descriptor.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">neuron_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.descriptor.Descriptor.add" title="Link to this definition"></a></dt>
<dd><p>Adds a neuron to the descriptor with its associated layer,
index, and properties.</p>
<p>This method registers a neuron name and associates it with a
layer, its index, and optional properties such as whether
the layer is an output or constant layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the layer where the neuron is located.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The index of the neuron within the layer.</p></li>
<li><p><strong>neuron_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the neuron.</p></li>
<li><p><strong>constant</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether the layer is a constant layer.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If a provided attribute has an incompatible type.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If a layer or index is already assigned for a neuron
    or a duplicate index is used within a layer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-congrads.metrics">
<span id="metrics"></span><h2>Metrics<a class="headerlink" href="#module-congrads.metrics" title="Link to this heading"></a></h2>
<p>This module defines the <cite>Metric</cite> and <cite>MetricManager</cite> classes, which are
used to track and aggregate performance metrics during model training or
evaluation in machine learning. These classes support the accumulation of
metric values, aggregation using customizable functions (such as mean),
and resetting of the metrics.</p>
<p>Classes:</p>
<blockquote>
<div><ul class="simple">
<li><p>Metric: A class that tracks and aggregates a specific metric over
multiple samples, allowing for accumulation, aggregation, and
resetting of values.</p></li>
<li><p>MetricManager: A class that manages and tracks multiple metrics
during model training or evaluation, supporting registration,
accumulation, aggregation, and resetting of metrics.</p></li>
</ul>
</div></blockquote>
<p>Key Methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>Metric.__init__</cite>: Initializes a metric with a specified name and
optional accumulator function (defaults to <cite>nanmean</cite>).</p></li>
<li><p><cite>Metric.accumulate</cite>: Accumulates a new value for the metric,
typically a tensor of model output or performance.</p></li>
<li><p><cite>Metric.aggregate</cite>: Aggregates the accumulated values using the
specified accumulator function.</p></li>
<li><p><cite>Metric.reset</cite>: Resets the accumulated values and sample count for
the metric.</p></li>
<li><p><cite>MetricManager.__init__</cite>: Initializes a manager for multiple metrics.</p></li>
<li><p><cite>MetricManager.register</cite>: Registers a new metric with a name, group,
and optional accumulator function.</p></li>
<li><p><cite>MetricManager.accumulate</cite>: Accumulates a new value for the specified
metric.</p></li>
<li><p><cite>MetricManager.aggregate</cite>: Aggregates all metrics in a specified group.</p></li>
<li><p><cite>MetricManager.reset</cite>: Resets all registered metrics in a specified
group.</p></li>
</ul>
</div></blockquote>
<p>Each class provides functionality to efficiently track, aggregate, and reset
metrics during the training and evaluation phases of machine learning tasks,
supporting flexible aggregation strategies and group-based management of
metrics.</p>
<dl class="py class">
<dt class="sig sig-object py" id="congrads.metrics.Metric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.metrics.</span></span><span class="sig-name descname"><span class="pre">Metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">name:</span> <span class="pre">str,</span> <span class="pre">accumulator:</span> <span class="pre">~typing.Callable[[...],</span> <span class="pre">~torch.Tensor]</span> <span class="pre">=</span> <span class="pre">&lt;built-in</span> <span class="pre">method</span> <span class="pre">nanmean</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.metrics.Metric" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class that tracks and aggregates a specific metric over multiple samples.</p>
<p>This class allows the accumulation of values, their aggregation using a
specified function (e.g., mean), and the ability to reset the metrics.
It is typically used to track performance metrics during training or
evaluation processes in machine learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the metric.</p></li>
<li><p><strong>accumulator</strong> (<em>Callable</em><em>[</em><em>...</em><em>, </em><em>Tensor</em><em>]</em><em>, </em><em>optional</em>) – A function used to</p></li>
<li><p><strong>values</strong> (<em>aggregate</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.metrics.Metric.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#congrads.metrics.Metric.name" title="Link to this definition"></a></dt>
<dd><p>The name of the metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.metrics.Metric.accumulator">
<span class="sig-name descname"><span class="pre">accumulator</span></span><a class="headerlink" href="#congrads.metrics.Metric.accumulator" title="Link to this definition"></a></dt>
<dd><p>The function used to aggregate
values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[…, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.metrics.Metric.values">
<span class="sig-name descname"><span class="pre">values</span></span><a class="headerlink" href="#congrads.metrics.Metric.values" title="Link to this definition"></a></dt>
<dd><p>A list to store accumulated values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.metrics.Metric.sample_count">
<span class="sig-name descname"><span class="pre">sample_count</span></span><a class="headerlink" href="#congrads.metrics.Metric.sample_count" title="Link to this definition"></a></dt>
<dd><p>The count of accumulated samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.metrics.Metric.accumulate">
<span class="sig-name descname"><span class="pre">accumulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#congrads.metrics.Metric.accumulate" title="Link to this definition"></a></dt>
<dd><p>Accumulates a new value for the metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> (<em>Tensor</em>) – The new value to accumulate, typically a
tensor of model output or performance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.metrics.Metric.aggregate">
<span class="sig-name descname"><span class="pre">aggregate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></span><a class="headerlink" href="#congrads.metrics.Metric.aggregate" title="Link to this definition"></a></dt>
<dd><p>Aggregates the accumulated values using the specified
accumulator function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The aggregated result of the accumulated values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.metrics.Metric.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#congrads.metrics.Metric.reset" title="Link to this definition"></a></dt>
<dd><p>Resets the accumulated values and sample count for the metric.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.metrics.MetricManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.metrics.</span></span><span class="sig-name descname"><span class="pre">MetricManager</span></span><a class="headerlink" href="#congrads.metrics.MetricManager" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A class to manage and track multiple metrics during model
training or evaluation.</p>
<p>This class allows registering metrics, accumulating values for each metric,
and recording the aggregated values. It also supports the reset of metrics
after each epoch or training step.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.metrics.MetricManager.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><a class="headerlink" href="#congrads.metrics.MetricManager.metrics" title="Link to this definition"></a></dt>
<dd><p>A dictionary of registered metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference internal" href="#congrads.metrics.Metric" title="congrads.metrics.Metric">Metric</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="congrads.metrics.MetricManager.groups">
<span class="sig-name descname"><span class="pre">groups</span></span><a class="headerlink" href="#congrads.metrics.MetricManager.groups" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping metric names to groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.metrics.MetricManager.accumulate">
<span class="sig-name descname"><span class="pre">accumulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#congrads.metrics.MetricManager.accumulate" title="Link to this definition"></a></dt>
<dd><p>Accumulates a new value for the specified metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the metric.</p></li>
<li><p><strong>value</strong> (<em>Tensor</em>) – The new value to accumulate.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.metrics.MetricManager.aggregate">
<span class="sig-name descname"><span class="pre">aggregate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.6)"><span class="pre">Tensor</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.metrics.MetricManager.aggregate" title="Link to this definition"></a></dt>
<dd><p>Aggregates all metrics in a group using the accumulators
specified during registration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the group.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary with the metric names and the</dt><dd><p>corresponding aggregated values of the selected group.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>, Tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.metrics.MetricManager.register">
<span class="sig-name descname"><span class="pre">register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">name:</span> <span class="pre">str,</span> <span class="pre">group:</span> <span class="pre">str,</span> <span class="pre">accumulator:</span> <span class="pre">~typing.Callable[[...],</span> <span class="pre">~torch.Tensor]</span> <span class="pre">=</span> <span class="pre">&lt;built-in</span> <span class="pre">method</span> <span class="pre">nanmean</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">object&gt;</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#congrads.metrics.MetricManager.register" title="Link to this definition"></a></dt>
<dd><p>Registers a new metric with the specified name and accumulator function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the metric to register.</p></li>
<li><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the group to assign the metric to.</p></li>
<li><p><strong>accumulator</strong> (<em>Callable</em><em>[</em><em>...</em><em>, </em><em>Tensor</em><em>]</em><em>, </em><em>optional</em>) – The function used
to aggregate values for the metric (defaults to <cite>nanmean</cite>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.metrics.MetricManager.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#congrads.metrics.MetricManager.reset" title="Link to this definition"></a></dt>
<dd><p>Resets all registered metrics in a group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the group.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-congrads.networks">
<span id="networks"></span><h2>Networks<a class="headerlink" href="#module-congrads.networks" title="Link to this heading"></a></h2>
<p>This module defines the <cite>MLPNetwork</cite> class, which constructs and
operates a multi-layer perceptron (MLP) neural network model. The MLP
network consists of an input layer, multiple hidden layers, and an
output layer. It allows for configurable hyperparameters such as the
number of input features, output features, number of hidden layers,
and the dimensionality of the hidden layers.</p>
<p>Classes:</p>
<blockquote>
<div><ul class="simple">
<li><p>MLPNetwork: A neural network model that implements a multi-layer
perceptron with customizable layers and dimensionalities.</p></li>
</ul>
</div></blockquote>
<p>Key Methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>__init__</cite>: Initializes the MLP network with specified input size,
output size, number of hidden layers, and hidden layer dimensionality.</p></li>
<li><p><cite>forward</cite>: Performs a forward pass through the network, returning
both the input and output of the model.</p></li>
<li><p><cite>linear</cite>: Creates a basic linear block consisting of a Linear layer
followed by a ReLU activation function.</p></li>
</ul>
</div></blockquote>
<p>The <cite>MLPNetwork</cite> class constructs a fully connected neural network with
multiple hidden layers, providing flexibility in designing the network
architecture. It can be used for regression, classification, or other
machine learning tasks that require a feedforward neural network structure.</p>
<dl class="py class">
<dt class="sig sig-object py" id="congrads.networks.MLPNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.networks.</span></span><span class="sig-name descname"><span class="pre">MLPNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_hidden_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.networks.MLPNetwork" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>A multi-layer perceptron (MLP) neural network model consisting of
an input layer, multiple hidden layers, and an output layer.</p>
<p>This class constructs an MLP with configurable hyperparameters such as the
number of input features, output features, number of hidden layers, and
the dimensionality of hidden layers. It provides methods for both
building the model and performing a forward pass through the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_inputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The number of input features. Defaults to 25.</p></li>
<li><p><strong>n_outputs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The number of output features. Defaults to 2.</p></li>
<li><p><strong>n_hidden_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The number of hidden layers.
Defaults to 2.</p></li>
<li><p><strong>hidden_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>optional</em>) – The dimensionality of the hidden layers.
Defaults to 35.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.networks.MLPNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.networks.MLPNetwork.forward" title="Link to this definition"></a></dt>
<dd><p>Performs a forward pass through the network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Tensor</em>) – The input tensor to be passed through the network.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the ‘input’ (original input) and
‘output’ (predicted output) of the network.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.networks.MLPNetwork.linear">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">linear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">in_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_features</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.networks.MLPNetwork.linear" title="Link to this definition"></a></dt>
<dd><p>Creates a basic linear block with a linear transformation followed
by a ReLU activation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of input features.</p></li>
<li><p><strong>out_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The number of output features.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A sequential module consisting of a Linear layer
and ReLU activation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-congrads.transformations">
<span id="transformations"></span><h2>Transformations<a class="headerlink" href="#module-congrads.transformations" title="Link to this heading"></a></h2>
<p>This module defines the abstract base class <cite>Transformation</cite> and two
specific transformations: <cite>IdentityTransformation</cite> and <cite>DenormalizeMinMax</cite>.
These transformations are used to apply operations to neuron data.</p>
<p>Classes:</p>
<blockquote>
<div><ul class="simple">
<li><p>Transformation: An abstract base class for transformations that
can be applied to neuron data. Subclasses must implement the
<cite>__call__</cite> method to apply the transformation.</p></li>
<li><p>IdentityTransformation: A subclass of <cite>Transformation</cite> that
returns the input data unchanged.</p></li>
<li><p>DenormalizeMinMax: A subclass of <cite>Transformation</cite> that denormalizes
input data based on specified minimum and maximum values.</p></li>
</ul>
</div></blockquote>
<p>Key Methods:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>__call__(data: Tensor) -&gt; Tensor</cite>: Abstract method in the
<cite>Transformation</cite> class that must be implemented by subclasses to apply
a transformation to the input data.</p></li>
<li><p><cite>__init__(neuron_name: str)</cite>: Initializes the transformation with the
associated neuron name.</p></li>
<li><p><cite>IdentityTransformation.__call__(data: Tensor) -&gt; Tensor</cite>: Returns
the input data without applying any transformation.</p></li>
<li><p><cite>DenormalizeMinMax.__call__(data: Tensor) -&gt; Tensor</cite>: Denormalizes
the input data by scaling it based on the specified min and max values.</p></li>
</ul>
</div></blockquote>
<p>The <cite>Transformation</cite> class is intended as a base class for creating
custom transformations for neuron data, while the <cite>IdentityTransformation</cite>
is used when no transformation is desired, and <cite>DenormalizeMinMax</cite> is used
for reversing the normalization process by using a min-max scaling approach.</p>
<dl class="py class">
<dt class="sig sig-object py" id="congrads.transformations.DenormalizeMinMax">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.transformations.</span></span><span class="sig-name descname"><span class="pre">DenormalizeMinMax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.13)"><span class="pre">Number</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.transformations.DenormalizeMinMax" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transformation</span></code></a></p>
<p>A transformation that denormalizes data based on a
specified min and max value.</p>
<p>This transformation scales the data by the range of the min and max values,
then adds the min value to denormalize it back to the original scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neuron_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the neuron associated with
the transformation.</p></li>
<li><p><strong>min</strong> (<em>Number</em>) – The minimum value to scale the data.</p></li>
<li><p><strong>max</strong> (<em>Number</em>) – The maximum value to scale the data.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__call__(data</span></span></dt>
<dd><p>Tensor) -&gt; Tensor:
Applies the denormalization to the given data by scaling it
with the min and max values.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.transformations.IdentityTransformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.transformations.</span></span><span class="sig-name descname"><span class="pre">IdentityTransformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.transformations.IdentityTransformation" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#congrads.transformations.Transformation" title="congrads.transformations.Transformation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transformation</span></code></a></p>
<p>A transformation that returns the data unchanged (identity transformation).</p>
<p>Inherits from the Transformation class and implements the
__call__ method to return the input data as is.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="congrads.transformations.Transformation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.transformations.</span></span><span class="sig-name descname"><span class="pre">Transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuron_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.transformations.Transformation" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract base class for transformations applied to neuron data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>neuron_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the neuron associated with
the transformation.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">__call__(data</span></span></dt>
<dd><p>Tensor) -&gt; Tensor:
Applies the transformation to the provided data.
Must be implemented by subclasses.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-congrads.utils">
<span id="utils"></span><h2>Utils<a class="headerlink" href="#module-congrads.utils" title="Link to this heading"></a></h2>
<p>This module provides utility functions and classes for managing data,
logging, and preprocessing in machine learning workflows. The functionalities
include logging key-value pairs to CSV files, splitting datasets into
training, validation, and test sets, preprocessing functions for various
data sets and validator functions for type checking.</p>
<dl class="py class">
<dt class="sig sig-object py" id="congrads.utils.CSVLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">congrads.utils.</span></span><span class="sig-name descname"><span class="pre">CSVLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.utils.CSVLogger" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A utility class for logging key-value pairs to a CSV file, organized by
epochs. Supports merging with existing logs or overwriting them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The path to the CSV file for logging.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, overwrites any existing file at
the file_path.</p></li>
<li><p><strong>merge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – If True, merges new values with existing data
in the file.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If both overwrite and merge are True.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileExistsError" title="(in Python v3.13)"><strong>FileExistsError</strong></a> – If the file already exists and neither
    overwrite nor merge is True.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="congrads.utils.CSVLogger.add_value">
<span class="sig-name descname"><span class="pre">add_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.utils.CSVLogger.add_value" title="Link to this definition"></a></dt>
<dd><p>Adds a value to the logger for a specific epoch and name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – The name of the metric or value to log.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – The value to log.</p></li>
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – The epoch associated with the value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.utils.CSVLogger.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#congrads.utils.CSVLogger.load" title="Link to this definition"></a></dt>
<dd><p>Loads data from the CSV file into the logger.</p>
<p>Converts the CSV data into the internal dictionary format for
further updates or operations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.utils.CSVLogger.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#congrads.utils.CSVLogger.save" title="Link to this definition"></a></dt>
<dd><p>Saves the logged values to the specified CSV file.</p>
<p>If the file exists and merge is enabled, merges the current data
with the existing file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.utils.CSVLogger.to_dataframe">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.3)"><span class="pre">DataFrame</span></a></span></span><a class="headerlink" href="#congrads.utils.CSVLogger.to_dataframe" title="Link to this definition"></a></dt>
<dd><p>Converts a dictionary of values into a DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – A dictionary of values
keyed by (epoch, name).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame where epochs are rows, names are
columns, and values are the cell data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="congrads.utils.CSVLogger.to_dict">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.3)"><span class="pre">DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.utils.CSVLogger.to_dict" title="Link to this definition"></a></dt>
<dd><p>Converts a DataFrame with epochs as rows and names as columns
back into a dictionary of the format {(epoch, name): value}.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="congrads.utils.preprocess_BiasCorrection">
<span class="sig-prename descclassname"><span class="pre">congrads.utils.</span></span><span class="sig-name descname"><span class="pre">preprocess_BiasCorrection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.3)"><span class="pre">DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.3)"><span class="pre">DataFrame</span></a></span></span><a class="headerlink" href="#congrads.utils.preprocess_BiasCorrection" title="Link to this definition"></a></dt>
<dd><p>Preprocesses the given dataframe for bias correction by
performing a series of transformations.</p>
<p>The function sequentially:</p>
<ul class="simple">
<li><p>Drops rows with missing values.</p></li>
<li><p>Converts a date string to datetime format and adds year, month,
and day columns.</p></li>
<li><p>Normalizes the columns with specific logic for input and output variables.</p></li>
<li><p>Adds a multi-index indicating which columns are input or output variables.</p></li>
<li><p>Samples 2500 examples from the dataset without replacement.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input dataframe containing the data
to be processed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed dataframe after applying
the transformations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="congrads.utils.preprocess_FamilyIncome">
<span class="sig-prename descclassname"><span class="pre">congrads.utils.</span></span><span class="sig-name descname"><span class="pre">preprocess_FamilyIncome</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.3)"><span class="pre">DataFrame</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.2.3)"><span class="pre">DataFrame</span></a></span></span><a class="headerlink" href="#congrads.utils.preprocess_FamilyIncome" title="Link to this definition"></a></dt>
<dd><p>Preprocesses the given Family Income dataframe by applying a
series of transformations and constraints.</p>
<p>The function sequentially:</p>
<ul class="simple">
<li><p>Drops rows with missing values.</p></li>
<li><p>Converts object columns to appropriate data types and
removes string columns.</p></li>
<li><p>Removes certain unnecessary columns like
‘Agricultural Household indicator’ and related features.</p></li>
<li><p>Adds labels to columns indicating whether they are
input or output variables.</p></li>
<li><p>Normalizes the columns individually.</p></li>
<li><p>Checks and removes rows that do not satisfy predefined constraints
(household income &gt; expenses, food expenses &gt; sub-expenses).</p></li>
<li><p>Samples 2500 examples from the dataset without replacement.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input Family Income dataframe containing
the data to be processed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed dataframe after applying the
transformations and constraints.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="congrads.utils.split_data_loaders">
<span class="sig-prename descclassname"><span class="pre">congrads.utils.</span></span><span class="sig-name descname"><span class="pre">split_data_loaders</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset" title="(in PyTorch v2.6)"><span class="pre">Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">loader_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_loader_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_loader_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Generator.html#torch.Generator" title="(in PyTorch v2.6)"><span class="pre">Generator</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.6)"><span class="pre">DataLoader</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.6)"><span class="pre">DataLoader</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.6)"><span class="pre">DataLoader</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#congrads.utils.split_data_loaders" title="Link to this definition"></a></dt>
<dd><p>Splits a dataset into training, validation, and test sets,
and returns corresponding DataLoader objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Dataset</em>) – The dataset to be split.</p></li>
<li><p><strong>loader_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Default DataLoader arguments, merges
with loader-specific arguments, overlapping keys from
loader-specific arguments are superseded.</p></li>
<li><p><strong>train_loader_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Training DataLoader arguments,
merges with <cite>loader_args</cite>, overriding overlapping keys.</p></li>
<li><p><strong>valid_loader_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Validation DataLoader arguments,
merges with <cite>loader_args</cite>, overriding overlapping keys.</p></li>
<li><p><strong>test_loader_args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>, </em><em>optional</em>) – Test DataLoader arguments,
merges with <cite>loader_args</cite>, overriding overlapping keys.</p></li>
<li><p><strong>train_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Proportion of data to be used for
training. Defaults to 0.8.</p></li>
<li><p><strong>valid_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Proportion of data to be used for
validation. Defaults to 0.1.</p></li>
<li><p><strong>test_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>optional</em>) – Proportion of data to be used for
testing. Defaults to 0.1.</p></li>
<li><p><strong>split_generator</strong> (<em>Generator</em><em>, </em><em>optional</em>) – Optional random seed generator
to control the splitting of the dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing three DataLoader objects: one for the
training, validation and test set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the train_size, valid_size, and test_size are not
    between 0 and 1, or if their sum does not equal 1.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="congrads.utils.validate_callable">
<span class="sig-prename descclassname"><span class="pre">congrads.utils.</span></span><span class="sig-name descname"><span class="pre">validate_callable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.utils.validate_callable" title="Link to this definition"></a></dt>
<dd><p>Validate that a value is callable function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the argument for error messages.</p></li>
<li><p><strong>value</strong> – Value to validate.</p></li>
<li><p><strong>allow_none</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to allow the value to be None.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If the value is not callable.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="congrads.utils.validate_comparator_pytorch">
<span class="sig-prename descclassname"><span class="pre">congrads.utils.</span></span><span class="sig-name descname"><span class="pre">validate_comparator_pytorch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.utils.validate_comparator_pytorch" title="Link to this definition"></a></dt>
<dd><p>Validate that a value is a callable PyTorch comparator function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the argument for error messages.</p></li>
<li><p><strong>value</strong> – Value to validate.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If the value is not callable or not a PyTorch comparator.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="congrads.utils.validate_iterable">
<span class="sig-prename descclassname"><span class="pre">congrads.utils.</span></span><span class="sig-name descname"><span class="pre">validate_iterable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_element_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_iterables=(&lt;class</span> <span class="pre">'list'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'set'&gt;)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.utils.validate_iterable" title="Link to this definition"></a></dt>
<dd><p>Validate that a value is an iterable (e.g., list, set) with elements of
the specified type(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the argument for error messages.</p></li>
<li><p><strong>value</strong> – Value to validate.</p></li>
<li><p><strong>expected_element_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><em>type</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> of </em><em>types</em>) – Expected type(s)
for the elements.</p></li>
<li><p><strong>allowed_iterables</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> of </em><em>types</em>) – Iterable types that are
allowed (default: list and set).</p></li>
<li><p><strong>allow_none</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to allow the value to be None.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If the value is not an allowed iterable type or if
    any element is not of the expected type(s).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="congrads.utils.validate_loaders">
<span class="sig-prename descclassname"><span class="pre">congrads.utils.</span></span><span class="sig-name descname"><span class="pre">validate_loaders</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#congrads.utils.validate_loaders" title="Link to this definition"></a></dt>
<dd><p>TODO: implement function</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="congrads.utils.validate_type">
<span class="sig-prename descclassname"><span class="pre">congrads.utils.</span></span><span class="sig-name descname"><span class="pre">validate_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expected_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_none</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#congrads.utils.validate_type" title="Link to this definition"></a></dt>
<dd><p>Validate that a value is of the specified type(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Name of the argument for error messages.</p></li>
<li><p><strong>value</strong> – Value to validate.</p></li>
<li><p><strong>expected_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.13)"><em>type</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a><em> of </em><em>types</em>) – Expected type(s) for the value.</p></li>
<li><p><strong>allow_none</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – Whether to allow the value to be None.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><strong>TypeError</strong></a> – If the value is not of the expected type(s).</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="concepts.html" class="btn btn-neutral float-left" title="Core concepts" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, DTAI KU Leuven.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>