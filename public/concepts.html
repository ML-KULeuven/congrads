

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Core concepts &mdash; Congrads 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="_static/congrads_favicon.png"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=292eb321"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API documentation" href="api.html" />
    <link rel="prev" title="Quick Start Guide" href="start.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #cc5353" >

          
          
          <a href="index.html" class="icon icon-home">
            Congrads
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="start.html">Quick Start Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Core concepts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#datasets">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#networks">Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#descriptor">Descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constraints">Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metricmanager">MetricManager</a></li>
<li class="toctree-l2"><a class="reference internal" href="#congradscore">CongradsCore</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #cc5353" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Congrads</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Core concepts</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/concepts.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="core-concepts">
<span id="concepts"></span><h1>Core concepts<a class="headerlink" href="#core-concepts" title="Link to this heading"></a></h1>
<p>The following sections provide a more in-depth exploration of the core concepts underlying the toolbox.
We delve into the fundamental assumptions and requirements, highlight key considerations to keep in mind, and present general examples to illustrate how to effectively utilize the toolbox in practice.</p>
<section id="datasets">
<h2>Datasets<a class="headerlink" href="#datasets" title="Link to this heading"></a></h2>
<p>The Congrads toolbox utilizes PyTorch’s <a class="reference external" href="https://pytorch.org/docs/stable/data.html#torch.utils.data.Dataset">Dataset</a> classes, allowing seamless integration with custom data sources.
PyTorch’s <cite>Dataset</cite> class provides a standardized way to represent datasets, making it easy to load, preprocess, and iterate over data efficiently.
By implementing custom dataset classes that inherit from <cite>torch.utils.data.Dataset</cite>, users can define how data is accessed, transformed, and batched.
This ensures compatibility with PyTorch’s <cite>DataLoader</cite>, enabling seamless integration into machine learning pipelines with minimal effort.</p>
<p>We provide two built-in datasets: <a class="reference internal" href="api.html#congrads.datasets.BiasCorrection" title="congrads.datasets.BiasCorrection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Bias</span> <span class="pre">Correction</span></code></a> and <a class="reference internal" href="api.html#congrads.datasets.FamilyIncome" title="congrads.datasets.FamilyIncome"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Family</span> <span class="pre">Income</span></code></a>, both featuring automatic downloading and built-in preprocessing transformations.
These datasets were initially used to evaluate the feasibility of the Constraint-Guided Gradient Descent (CGGD) technique (see the <a class="reference external" href="https://www.sciencedirect.com/science/article/abs/pii/S0925231223007592">manuscript</a> for details).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">congrads.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">FamilyIncome</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">congrads.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">preprocess_FamilyIncome</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">FamilyIncome</span><span class="p">(</span><span class="s2">&quot;./datasets&quot;</span><span class="p">,</span> <span class="n">preprocess_FamilyIncome</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The provided function <code class="docutils literal notranslate"><span class="pre">`split_data_loaders`</span></code> can be used to divide the data into three parts with configurable ratios: for training, validation and testing.
The CongradsCore requires these loaders to function. You can also write your own function to divide the data into loaders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">congrads.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">split_data_loaders</span>

<span class="n">loaders</span> <span class="o">=</span> <span class="n">split_data_loaders</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span>
    <span class="n">loader_args</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;num_workers&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;prefetch_factor&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">valid_loader_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
    <span class="n">test_loader_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shuffle&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="networks">
<h2>Networks<a class="headerlink" href="#networks" title="Link to this heading"></a></h2>
<p>You are free to define your own neural network (model) however you want. We only require it to extend the PyTorch <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module">torch.nn.Module</a> class and it to output a dictionary structure.
The network’s output must have the key “output”. Other layers, such as input or intermediary layers, can be named to your liking.
When placing constraints on your network, you will use the layer names and an index to refer to specific neurons in the network.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Model</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;input&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;middle&quot;</span><span class="p">:</span> <span class="n">a</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">b</span><span class="p">}</span> <span class="c1"># Output a dictionary</span>
</pre></div>
</div>
<p>We also provide a basic Multi-Layer Perceptron (MLP) network using ReLU activations that can be easily configured to match your dataset format.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">congrads.networks</span><span class="w"> </span><span class="kn">import</span> <span class="n">MLPNetwork</span>

<span class="n">network</span> <span class="o">=</span> <span class="n">MLPNetwork</span><span class="p">(</span>
    <span class="n">n_inputs</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">n_outputs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_hidden_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">10</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="descriptor">
<h2>Descriptor<a class="headerlink" href="#descriptor" title="Link to this heading"></a></h2>
<p>The descriptor class forms a translation manager that will attach human-readable names to specific points in your neural network.
It represents your problem and has the structure of the neural network, while having names that relate to your dataset.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">descriptor.add(layer,</span> <span class="pre">index,</span> <span class="pre">name,</span> <span class="pre">...)</span></code> method is used to reference specific components of the neural network.
The layer argument identifies a network section based on predefined dictionary keys, while index specifies a particular neuron within that layer.
You must assign a name to each neuron (dataset column) that you plan to attach a constraints on so it can be referenced easily.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The neural network receives data in the order it is defined in the dataset.
For example, if your dataset has three columns—A (input) and B, C (outputs)—refer to A using index 0 and B, C using indices 0 and 1, respectively.</p>
</div>
<p>Certain parts of your network may be non-learnable and should be excluded from the CGGD (Congrads) algorithm.
For example, network inputs are always fixed and cannot be optimized.
To exclude a specific neuron from the learning process, set its attribute to <code class="docutils literal notranslate"><span class="pre">`constant=True`</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">congrads.descriptor</span><span class="w"> </span><span class="kn">import</span> <span class="n">Descriptor</span>

<span class="n">descriptor</span> <span class="o">=</span> <span class="n">Descriptor</span><span class="p">()</span>
<span class="n">descriptor</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Date&quot;</span><span class="p">,</span> <span class="n">constant</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">descriptor</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Minimum temperature&quot;</span><span class="p">)</span>
<span class="n">descriptor</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Maximum temperature&quot;</span><span class="p">)</span>
<span class="n">descriptor</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Normalized minimum sunshine&quot;</span><span class="p">)</span>
<span class="n">descriptor</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Normalized maximum sunshine&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="constraints">
<h2>Constraints<a class="headerlink" href="#constraints" title="Link to this heading"></a></h2>
<p>Constraints are a fundamental part of the Congrads toolbox, allowing you to define relationships between different sections of your dataset—or, in other words, between neurons in your network.</p>
<p>To set up a constraint, the names assigned in the descriptor are used to reference specific data.
The relationship between them is defined using a comparator function, which can be one of PyTorch’s built-in comparison functions (<code class="docutils literal notranslate"><span class="pre">`torch.lt`</span></code>, <code class="docutils literal notranslate"><span class="pre">`torch.gt`</span></code>, <code class="docutils literal notranslate"><span class="pre">`torch.le`</span></code>, <code class="docutils literal notranslate"><span class="pre">`torch.ge`</span></code>).</p>
<p>Additionally, constraints can accept transformations instead of direct descriptor names.
This enables you to apply a function or transformation to the data before evaluating whether the constraint is satisfied.
This can be useful to undo an operation that was done in preprocessing for example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Constraint</span><span class="o">.</span><span class="n">descriptor</span> <span class="o">=</span> <span class="n">descriptor</span>
<span class="n">Constraint</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="n">device</span>
<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">BinaryConstraint</span><span class="p">(</span><span class="s2">&quot;Minimum temperature&quot;</span><span class="p">,</span> <span class="n">le</span><span class="p">,</span> <span class="s2">&quot;Maximum temperature&quot;</span><span class="p">),</span>
    <span class="n">ScalarConstraint</span><span class="p">(</span><span class="s2">&quot;Normalized minimum sunshine&quot;</span><span class="p">,</span> <span class="n">ge</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">BinaryConstraint</span><span class="p">(</span>
        <span class="n">DenormalizeMinMax</span><span class="p">(</span>
            <span class="s2">&quot;Normalized minimum sunshine&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">32</span>
        <span class="p">),</span>
        <span class="n">le</span><span class="p">,</span>
        <span class="n">DenormalizeMinMax</span><span class="p">(</span>
            <span class="s2">&quot;Normalized maximum sunshine&quot;</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">124</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">324</span>
        <span class="p">),</span>
    <span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The above code translates into the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">`Minimum</span> <span class="pre">temperature`</span></code> <span class="math notranslate nohighlight">\(\leq\)</span> <code class="docutils literal notranslate"><span class="pre">`Maximum</span> <span class="pre">temperature`</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">`Normalized</span> <span class="pre">minimum</span> <span class="pre">sunshine`</span></code> <span class="math notranslate nohighlight">\(\geq\)</span> 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">`Minimum</span> <span class="pre">sunshine`</span></code> <span class="math notranslate nohighlight">\(\leq\)</span> <code class="docutils literal notranslate"><span class="pre">`Maximum</span> <span class="pre">sunshine`</span></code></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Constraints are always placed on data as it is present in the network. If the network
outputs normalized predictions, the constraints also have to be formulated as such.
A transformation can be used to apply a calculation before processing the constraints, such as a denormalization.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When placing a constraint between neurons in the network, you must make sure they can be compared sensibly.
For example, you cannot directly compare two neurons that were normalized differently (e.g. with a different min/max range).
You can use a transformation to first denormalize each neuron, to then make the comparison on original data.</p>
</div>
<p>It is possible to implement your own custom constraints to allow for additional complexity in your network.
A new constraint must extend the base <code class="docutils literal notranslate"><span class="pre">`Constraint`</span></code> class and implement the <a class="reference internal" href="api.html#congrads.constraints.Constraint.check_constraint" title="congrads.constraints.Constraint.check_constraint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">check_constraint(...)</span></code></a> <a class="reference internal" href="api.html#congrads.constraints.Constraint.calculate_direction" title="congrads.constraints.Constraint.calculate_direction"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calculate_direction(...)</span></code></a> methods.
Please refer to the built in constraints for examples how to achieve this.</p>
</section>
<section id="metricmanager">
<h2>MetricManager<a class="headerlink" href="#metricmanager" title="Link to this heading"></a></h2>
<p>To be able to track the Constraint Satisfaction Ratio (CSR), a score between 0 and 1 that indicates how well the constraint is satisfied, the MetricManager</p>
<p>All metric values can be calculated and retrieved using <a class="reference internal" href="api.html#congrads.metrics.MetricManager.aggregate" title="congrads.metrics.MetricManager.aggregate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">metric_manager.aggregate(group)</span></code></a>, after which they can be logged to TensorBoard, a CSV file or other storage methods using the hooks, such as the example below.
Metrics having group “during_training” will update every epoch, having group “after_training” are calculated only when the training is finished.
The <a class="reference internal" href="api.html#congrads.metrics.MetricManager.reset" title="congrads.metrics.MetricManager.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">metric_manager.reset(group)</span></code></a> method will reset the metric for a specific group so that new values can be stored for a next iteration.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">torch.utils.tensorboard</span><span class="w"> </span><span class="kn">import</span> <span class="n">SummaryWriter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">congrads.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">MetricManager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">congrads.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSVLogger</span>

<span class="c1"># Initialize metric manager</span>
<span class="n">metric_manager</span> <span class="o">=</span> <span class="n">MetricManager</span><span class="p">()</span>

<span class="c1"># Initialize data loggers</span>
<span class="n">tensorboard_logger</span> <span class="o">=</span> <span class="n">SummaryWriter</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;logs/FamilyIncome&quot;</span><span class="p">)</span>
<span class="n">csv_logger</span> <span class="o">=</span> <span class="n">CSVLogger</span><span class="p">(</span><span class="s2">&quot;logs/FamilyIncome.csv&quot;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">on_epoch_end</span><span class="p">(</span><span class="n">epoch</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="c1"># Log metric values to TensorBoard and CSV file</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metric_manager</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="s2">&quot;during_training&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">tensorboard_logger</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">epoch</span><span class="p">)</span>
        <span class="n">csv_logger</span><span class="o">.</span><span class="n">add_value</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="n">epoch</span><span class="p">)</span>

    <span class="c1"># Write changes to disk</span>
    <span class="n">tensorboard_logger</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">csv_logger</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="c1"># Reset metric manager</span>
    <span class="n">metric_manager</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="s2">&quot;during_training&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="congradscore">
<h2>CongradsCore<a class="headerlink" href="#congradscore" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">`CongradsCore`</span></code> integrates all the previously discussed concepts, along with additional configuration settings such as the loss function, optimizer, dataloaders, network architecture, and more.
It brings together these elements to form a cohesive framework that ensures smooth execution of the Congrads algorithm, guiding the neural network’s training process while adhering to constraints and other user-defined parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">core</span> <span class="o">=</span> <span class="n">CongradsCore</span><span class="p">(</span>
    <span class="n">descriptor</span><span class="p">,</span>
    <span class="n">constraints</span><span class="p">,</span>
    <span class="n">loaders</span><span class="p">,</span>
    <span class="n">network</span><span class="p">,</span>
    <span class="n">criterion</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="p">,</span>
    <span class="n">metric_manager</span><span class="p">,</span>
    <span class="n">device</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can then call <a class="reference internal" href="api.html#congrads.core.CongradsCore.fit" title="congrads.core.CongradsCore.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">core.fit(...)</span></code></a> to start the training process.
Attach functions via the hooks like <code class="docutils literal notranslate"><span class="pre">`on_epoch_end`</span></code>, <code class="docutils literal notranslate"><span class="pre">`on_train_end`</span></code> to execute your custom code at certain points in the training process.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">core</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">start_epoch</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
    <span class="n">on_epoch_end</span><span class="o">=</span><span class="n">on_epoch_end</span><span class="p">,</span>
    <span class="n">on_train_end</span><span class="o">=</span><span class="n">on_train_end</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="start.html" class="btn btn-neutral float-left" title="Quick Start Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, DTAI KU Leuven.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>